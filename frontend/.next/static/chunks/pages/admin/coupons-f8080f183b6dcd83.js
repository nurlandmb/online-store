(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[557],{1608:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/coupons",function(){return t(4056)}])},8652:function(n,e,t){"use strict";t.d(e,{Z:function(){return o}});var r=t(5893);function o(n){return(0,r.jsx)("div",{className:n.fixed?"loader-wrapper fixed ".concat(n.addClass):"loader-wrapper ".concat(n.addClass),children:(0,r.jsxs)("div",{className:"loader",children:[(0,r.jsx)("div",{}),(0,r.jsx)("div",{})]})})}t(7294)},4056:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return N}});var r=t(7568),o=t(1799),a=t(9396),s=t(828),u=t(943),c=t(3375),i=t(1566);function l(n){return function(n){if(Array.isArray(n))return(0,u.Z)(n)}(n)||(0,c.Z)(n)||(0,i.Z)(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=t(655),d=t(5893),f=t(9669),m=t.n(f),h=t(7294),_=t(6064),v=t(8652),x=t(7329),j=function(n){var e=n.coupon,t=n.couponDelete,r=e.name,o=e.discount;return(0,d.jsxs)("div",{className:"admin-coupon",children:[(0,d.jsxs)("div",{className:"admin-coupon__wrapper",children:[(0,d.jsx)("h3",{className:"admin-coupon__title",children:r}),(0,d.jsxs)("p",{className:"admin-coupon__discount",children:[o,"%"]})]}),(0,d.jsx)("button",{className:"admin-coupon__delete",onClick:function(){return t(r)},children:"Удалить"})]})},b=t(1163);m().defaults.baseURL="http://localhost:5000";var N=(0,_.$j)(function(n){return{profile:n.profile}})(function(n){var e,t,u,c=(0,b.useRouter)(),i=(0,s.Z)((0,h.useState)(""),2);i[0],i[1];var f=(0,s.Z)((0,h.useState)(),2);f[0],f[1];var _=(0,s.Z)((0,h.useState)(!1),2);_[0],_[1];var N=(0,s.Z)((0,h.useState)(!1),2),g=N[0],Z=N[1],w=(0,s.Z)((0,h.useState)(!1),2),y=w[0],k=w[1],C=(0,s.Z)((0,h.useState)({name:"",discount:""}),2),S=C[0],E=C[1],I=(0,s.Z)((0,h.useState)([]),2),A=I[0],z=I[1],B=(0,s.Z)((0,h.useState)([]),2),D=B[0],F=B[1],P=(e=(0,r.Z)(function(e){var t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:Z(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m().delete("/api/coupon/".concat(e),{headers:{Authorization:"Bearer ".concat(n.profile.userInfo.token)}})];case 2:return r.sent(),F(l(D.filter(function(n){return n.name!==e}))),Z(!1),[3,4];case 3:return t=r.sent(),alert("Что-то пошло не так"),console.log(t),[3,4];case 4:return[2]}})}),function(n){return e.apply(this,arguments)}),T=(t=(0,r.Z)(function(){var e;return(0,p.__generator)(this,function(t){switch(t.label){case 0:return console.log(n.profile),Z(!0),[4,m().get("/api/coupon/",{headers:{Authorization:"Bearer ".concat(n.profile.userInfo.token)}})];case 1:return F(e=t.sent().data),Z(!1),console.log(e),[2]}})}),function(){return t.apply(this,arguments)});(0,h.useEffect)(function(){n.profile.isLoggedIn?T():c.push("/admin/signin")},[]);var L=(u=(0,r.Z)(function(e){var t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:if(e.preventDefault(),!O())return[2];Z(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m().post("/api/coupon/save/",S,{headers:{Authorization:"Bearer ".concat(n.profile.userInfo.token)}})];case 2:return r.sent(),T(),k(!1),E({name:"",discount:""}),[3,4];case 3:return t=r.sent(),alert("Что-то пошло не так"),console.log(t),[3,4];case 4:return Z(!1),[2]}})}),function(n){return u.apply(this,arguments)}),O=function(){var n=[],e=!0;return S.name.trim().length||(n.push("name"),e=!1),S.discount.trim().length||(n.push("discount"),e=!1),z(n),e};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(x.Z,{addClass:"admin-coupons__popup",active:y,closePopup:function(){return k(!1)},children:(0,d.jsxs)("form",{className:g?"admin-coupons__popup-form disabled":"admin-coupons__popup-form",onSubmit:L,children:[(0,d.jsxs)("label",{className:A.includes("name")?"admin-coupons__popup-form__label wrong":"admin-coupons__popup-form__label",children:[(0,d.jsx)("input",{type:"text",value:S.name,onChange:function(n){return E((0,a.Z)((0,o.Z)({},S),{name:n.target.value}))},onFocus:function(){return z(l(A.filter(function(n){return"name"!==n})))}}),(0,d.jsx)("span",{className:S.name.length?"active":"",children:"Название"})]}),(0,d.jsxs)("label",{className:A.includes("discount")?"admin-coupons__popup-form__label wrong":"admin-coupons__popup-form__label",children:[(0,d.jsx)("input",{type:"number",value:S.discount,min:"1",max:"100",onChange:function(n){return E((0,a.Z)((0,o.Z)({},S),{discount:n.target.value}))},onFocus:function(){return z(l(A.filter(function(n){return"discount"!==n})))}}),(0,d.jsx)("span",{className:S.discount.length?"active":"",children:"Процент"})]}),(0,d.jsx)("button",{className:"admin-coupons__popup-form__submit",children:"Сохранить"})]})}),(0,d.jsx)("section",{className:"section admin-coupons",children:(0,d.jsxs)("div",{className:"container",children:[(0,d.jsxs)("div",{className:"admin-coupons__top",children:[(0,d.jsx)("h2",{className:"section-title",children:"Все купоны"}),(0,d.jsx)("button",{onClick:function(){return k(!0)},children:"Добавить купон"})]}),g?(0,d.jsx)(v.Z,{addClass:"dark",fixed:!0}):(0,d.jsx)("ul",{className:"admin-coupons__list",children:D.map(function(n){return(0,d.jsx)(j,{coupon:n,couponDelete:P},n._id)})})]})})]})})}},function(n){n.O(0,[774,888,179],function(){return n(n.s=1608)}),_N_E=n.O()}]);